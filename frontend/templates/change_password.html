{% extends "_base.html" %}

{% block title %}Alterar Senha{% endblock %}

{% block content %}
<section class="card">
    <h2>Alterar Senha</h2>
    <form action="{{ url_for('change_password') }}" method="POST">
        <div class="form-group">
            <label for="current_password">Senha Atual:</label>
            <input type="password" id="current_password" name="current_password" required autocomplete="current-password">
        </div>
        <div class="form-group">
            <label for="new_password">Nova Senha:</label>
            <input type="password" id="new_password" name="new_password" required autocomplete="new-password">
            <small>Mínimo de 8 caracteres, incluindo pelo menos um símbolo (ex: !@#$%).</small>
        </div>
        <div class="form-group">
            <label for="confirm_password">Confirme a Nova Senha:</label>
            <input type="password" id="confirm_password" name="confirm_password" required autocomplete="new-password">
        </div>

        {% if user.is_2fa_enabled %}
        <hr>
        <div class="form-group">
            <label for="2fa_code">Código 2FA:</label>
            <input type="text" id="2fa_code" name="2fa_code" required autocomplete="one-time-code" pattern="\d{6}">
            <small>Digite o código do seu aplicativo autenticador para confirmar a alteração.</small>
        </div>
        {% endif %}

        <div class="form-actions">
            <button type="submit" class="btn btn-danger">Salvar Nova Senha</button>
            <a href="{{ url_for('profile') }}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</section>
{% endblock %}
